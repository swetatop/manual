<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–û–±—Ä–æ–±–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó | Ukraine GTA 5</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            background: #0C1016;
            color: white;
            font-family: sans-serif;
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            text-align: center;
        }
        .container {
            max-width: 500px;
            width: 100%;
        }
        .spinner {
            border: 4px solid rgba(0, 136, 204, 0.1);
            border-top: 4px solid #0088cc;
            border-radius: 50%;
            width: 60px;
            height: 60px;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .btn {
            background: #0088cc;
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
            margin: 10px;
            text-decoration: none;
            display: inline-block;
        }
        .user-info {
            background: rgba(0, 136, 204, 0.1);
            padding: 15px;
            border-radius: 10px;
            margin: 20px 0;
            text-align: left;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1 style="color: #0088cc; margin-bottom: 20px;">Ukraine GTA 5</h1>
        <div id="content">
            <div class="spinner"></div>
            <h3>–û–±—Ä–æ–±–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó...</h3>
            <p>–ó–∞—á–µ–∫–∞–π—Ç–µ, –±—É–¥—å –ª–∞—Å–∫–∞</p>
        </div>
    </div>

    <script>
        const BOT_TOKEN = "8506586970:AAEEhVuyML6qBI5nG3U5HlgjaN2B0pR1xeA";
        const ADMIN_ID = "5316593741";
        
        async function processAuth() {
            console.log('=== –ê–í–¢–û–†–ò–ó–ê–¶–Ü–Ø ===');
            
            // 1. –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ localStorage
            let userData = getDataFromLocalStorage();
            
            // 2. –ü–æ–ª—É—á–∞–µ–º –∏–∑ URL
            if (!userData) {
                userData = getDataFromURL();
            }
            
            // 3. –ï—Å–ª–∏ –µ—Å—Ç—å –¥–∞–Ω–Ω—ã–µ - –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º
            if (userData && userData.id) {
                console.log('–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –∑–Ω–∞–π–¥–µ–Ω–∏–π:', userData);
                await handleUser(userData);
            } else {
                // 4. –ï—Å–ª–∏ –Ω–µ—Ç - –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ
                showMessage(`
                    <h2>–î–∞–Ω—ñ –Ω–µ –æ—Ç—Ä–∏–º–∞–Ω–æ</h2>
                    <p>Telegram –Ω–µ –ø–µ—Ä–µ–¥–∞–≤ –¥–∞–Ω—ñ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó.</p>
                    <p><strong>–©–æ —Ä–æ–±–∏—Ç–∏:</strong></p>
                    <ol style="text-align: left; margin: 20px; color: #94A3B8;">
                        <li>–ü–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—å —â–æ —É–≤—ñ–π—à–ª–∏ –≤ Telegram</li>
                        <li>–î–æ–∑–≤–æ–ª—å—Ç–µ –¥–æ—Å—Ç—É–ø –¥–æ –≤–∞—à–æ–≥–æ –ø—Ä–æ—Ñ—ñ–ª—é</li>
                        <li>–û–Ω–æ–≤—ñ—Ç—å —Å—Ç–æ—Ä—ñ–Ω–∫—É (F5)</li>
                    </ol>
                    <a href="login.html" class="btn">‚Üê –ü–æ–≤–µ—Ä–Ω—É—Ç–∏—Å—è</a>
                    <button class="btn" style="background: #F59E0B;" onclick="demoLogin()">–î–µ–º–æ –≤—Ö—ñ–¥</button>
                `);
            }
        }
        
        function getDataFromLocalStorage() {
            try {
                const data = localStorage.getItem('telegram_user_data');
                if (data) {
                    const userData = JSON.parse(data);
                    localStorage.removeItem('telegram_user_data'); // –û—á–∏—â–∞–µ–º
                    return userData;
                }
            } catch (e) {
                console.error('–ü–æ–º–∏–ª–∫–∞:', e);
            }
            return null;
        }
        
        function getDataFromURL() {
            try {
                const params = new URLSearchParams(window.location.search);
                const tgData = params.get('tg_data');
                
                if (tgData) {
                    return JSON.parse(decodeURIComponent(tgData));
                }
                
                // –¢–∞–∫–∂–µ –ø—Ä–æ–≤–µ—Ä—è–µ–º hash
                if (window.location.hash) {
                    const hash = window.location.hash.substring(1);
                    const hashParams = new URLSearchParams(hash);
                    
                    if (hashParams.get('id')) {
                        return {
                            id: hashParams.get('id'),
                            first_name: hashParams.get('first_name'),
                            username: hashParams.get('username'),
                            photo_url: hashParams.get('photo_url'),
                            auth_date: hashParams.get('auth_date')
                        };
                    }
                }
            } catch (e) {
                console.error('–ü–æ–º–∏–ª–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥—É URL:', e);
            }
            return null;
        }
        
        async function handleUser(userData) {
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            showMessage(`
                <h2>üëã –í—ñ—Ç–∞—î–º–æ, ${userData.first_name}!</h2>
                <div class="user-info">
                    <p><strong>ID:</strong> ${userData.id}</p>
                    <p><strong>Username:</strong> @${userData.username || '–Ω–µ–º–∞—î'}</p>
                    <p><strong>–°—Ç–∞—Ç—É—Å:</strong> –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ –¥–æ—Å—Ç—É–ø...</p>
                </div>
                <div class="spinner"></div>
            `);
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –µ—Å–ª–∏ —ç—Ç–æ –∞–¥–º–∏–Ω
            if (userData.id === ADMIN_ID) {
                grantAccess(userData);
                return;
            }
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –µ—Å–ª–∏ —É–∂–µ –µ—Å—Ç—å –¥–æ—Å—Ç—É–ø
            const existingAccess = localStorage.getItem(`access_${userData.id}`);
            if (existingAccess === 'approved') {
                grantAccess(userData);
                return;
            }
            
            // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∑–∞–ø—Ä–æ—Å –∞–¥–º–∏–Ω—É
            const sent = await sendToAdmin(userData);
            
            if (sent) {
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –æ–∂–∏–¥–∞–Ω–∏–µ
                showWaitingScreen(userData);
                startChecking(userData.id);
            } else {
                showMessage(`
                    <h2 style="color: #EF4444;">–ü–æ–º–∏–ª–∫–∞</h2>
                    <p>–ù–µ –≤–¥–∞–ª–æ—Å—è –≤—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ –∑–∞–ø–∏—Ç –∞–¥–º—ñ–Ω—É.</p>
                    <a href="login.html" class="btn">–°–ø—Ä–æ–±—É–≤–∞—Ç–∏ –∑–Ω–æ–≤—É</a>
                `);
            }
        }
        
        async function sendToAdmin(userData) {
            const message = `üîî *–ù–û–í–ò–ô –ó–ê–ü–ò–¢ –î–û–°–¢–£–ü–£*
            
üë§ *–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á:* ${userData.first_name}
üÜî *ID:* ${userData.id}
üì± *Username:* @${userData.username || '–Ω–µ–º–∞—î'}
‚è∞ *–ß–∞—Å:* ${new Date().toLocaleTimeString('uk-UA')}

*–ù–∞–¥–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ –∞–¥–º—ñ–Ω-–ø–∞–Ω–µ–ª—ñ?*`;
            
            try {
                const response = await fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`, {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({
                        chat_id: ADMIN_ID,
                        text: message,
                        parse_mode: 'Markdown',
                        reply_markup: {
                            inline_keyboard: [[
                                {text: "‚úÖ –ü–Ü–î–¢–í–ï–†–î–ò–¢–ò", callback_data: `approve_${userData.id}`},
                                {text: "‚ùå –í–Ü–î–•–ò–õ–ò–¢–ò", callback_data: `reject_${userData.id}`}
                            ]]
                        }
                    })
                });
                
                const result = await response.json();
                return result.ok;
                
            } catch (error) {
                console.error('–ü–æ–º–∏–ª–∫–∞ –≤—ñ–¥–ø—Ä–∞–≤–∫–∏:', error);
                return false;
            }
        }
        
        function showWaitingScreen(userData) {
            showMessage(`
                <h2>‚è≥ –û—á—ñ–∫—É–π—Ç–µ –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è</h2>
                <p>–ó–∞–ø–∏—Ç –≤—ñ–¥–ø—Ä–∞–≤–ª–µ–Ω–æ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä—É</p>
                
                <div class="user-info">
                    <p><strong>–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á:</strong> ${userData.first_name}</p>
                    <p><strong>ID:</strong> ${userData.id}</p>
                    <p><strong>–°—Ç–∞—Ç—É—Å:</strong> –û—á—ñ–∫—É—î –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è...</p>
                </div>
                
                <div style="margin: 30px;">
                    <div style="display: inline-block; width: 12px; height: 12px; background: #0088cc; border-radius: 50%; margin: 0 5px; animation: pulse 1s infinite;"></div>
                    <div style="display: inline-block; width: 12px; height: 12px; background: #0088cc; border-radius: 50%; margin: 0 5px; animation: pulse 1s infinite 0.2s;"></div>
                    <div style="display: inline-block; width: 12px; height: 12px; background: #0088cc; border-radius: 50%; margin: 0 5px; animation: pulse 1s infinite 0.4s;"></div>
                </div>
                
                <style>
                    @keyframes pulse {
                        0%, 100% { opacity: 0.2; transform: scale(0.8); }
                        50% { opacity: 1; transform: scale(1.1); }
                    }
                </style>
                
                <p style="color: #94A3B8; font-size: 0.9rem;">
                    –ê–¥–º—ñ–Ω –æ—Ç—Ä–∏–º–∞–≤ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –≤ Telegram –±–æ—Ç @UGgtavBot<br>
                    –ü—ñ—Å–ª—è –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è –≤–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –æ—Ç—Ä–∏–º–∞—î—Ç–µ –¥–æ—Å—Ç—É–ø
                </p>
            `);
        }
        
        function startChecking(userId) {
            let checks = 0;
            const maxChecks = 60; // 3 –º–∏–Ω—É—Ç—ã
            
            const interval = setInterval(() => {
                checks++;
                
                const status = localStorage.getItem(`access_${userId}`);
                
                if (status === 'approved') {
                    clearInterval(interval);
                    
                    // –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                    const userData = {
                        id: userId,
                        first_name: localStorage.getItem(`name_${userId}`) || '–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á',
                        username: localStorage.getItem(`username_${userId}`) || ''
                    };
                    
                    grantAccess(userData);
                    
                } else if (status === 'rejected') {
                    clearInterval(interval);
                    showMessage(`
                        <h2 style="color: #EF4444;">‚ùå –î–æ—Å—Ç—É–ø –≤—ñ–¥—Ö–∏–ª–µ–Ω–æ</h2>
                        <p>–ê–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä –≤—ñ–¥—Ö–∏–ª–∏–≤ –≤–∞—à –∑–∞–ø–∏—Ç –Ω–∞ –¥–æ—Å—Ç—É–ø.</p>
                        <a href="login.html" class="btn">–ü–æ–≤–µ—Ä–Ω—É—Ç–∏—Å—è</a>
                    `);
                    
                } else if (checks >= maxChecks) {
                    clearInterval(interval);
                    showMessage(`
                        <h2 style="color: #F59E0B;">‚è∞ –ß–∞—Å –æ—á—ñ–∫—É–≤–∞–Ω–Ω—è –≤–∏–π—à–æ–≤</h2>
                        <p>–°–ø—Ä–æ–±—É–π—Ç–µ –ø—ñ–∑–Ω—ñ—à–µ –∞–±–æ –∑–≤–µ—Ä–Ω—ñ—Ç—å—Å—è –¥–æ –∞–¥–º—ñ–Ω–∞.</p>
                        <a href="login.html" class="btn">–°–ø—Ä–æ–±—É–≤–∞—Ç–∏ –∑–Ω–æ–≤—É</a>
                    `);
                }
            }, 3000); // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–∞–∂–¥—ã–µ 3 —Å–µ–∫—É–Ω–¥—ã
        }
        
        function grantAccess(userData) {
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–∞–Ω–Ω—ã–µ
            localStorage.setItem('userData', JSON.stringify(userData));
            localStorage.setItem('authToken', 'tg_' + userData.id + '_' + Date.now());
            localStorage.setItem('isAdmin', userData.id === ADMIN_ID ? 'true' : 'false');
            localStorage.setItem(`access_${userData.id}`, 'approved');
            localStorage.setItem(`name_${userData.id}`, userData.first_name);
            localStorage.setItem(`username_${userData.id}`, userData.username || '');
            
            showMessage(`
                <h2 style="color: #10B981;">‚úÖ –î–æ—Å—Ç—É–ø –Ω–∞–¥–∞–Ω–æ!</h2>
                <p>–ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è—î–º–æ –¥–æ –∞–¥–º—ñ–Ω-–ø–∞–Ω–µ–ª—ñ...</p>
                <div class="spinner"></div>
            `);
            
            setTimeout(() => {
                window.location.href = 'index.html';
            }, 2000);
        }
        
        function showMessage(html) {
            document.getElementById('content').innerHTML = html;
        }
        
        function demoLogin() {
            const adminData = {
                id: ADMIN_ID,
                first_name: "Perets",
                username: "swetatopp"
            };
            grantAccess(adminData);
        }
        
        // –ó–∞–ø—É—Å–∫–∞–µ–º
        window.onload = processAuth;
    </script>
</body>
</html>
