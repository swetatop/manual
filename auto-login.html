<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <title>–ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–π –≤—Ö—ñ–¥ | Ukraine GTA 5</title>
    <style>
        body {
            background: #0f1419;
            color: white;
            font-family: sans-serif;
            text-align: center;
            padding: 50px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            margin: 0;
        }
        
        .container {
            max-width: 500px;
            width: 100%;
            background: #1a2029;
            padding: 40px;
            border-radius: 20px;
            border: 1px solid #2D3748;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }
        
        .logo {
            width: 80px;
            height: 80px;
            background: linear-gradient(135deg, #3B82F6, #8B5CF6);
            border-radius: 50%;
            margin: 0 auto 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 36px;
            color: white;
        }
        
        .status-box {
            padding: 25px;
            border-radius: 12px;
            margin: 25px 0;
            font-size: 16px;
            line-height: 1.6;
        }
        
        .loading { background: rgba(59, 130, 246, 0.1); border: 1px solid #3B82F6; }
        .success { background: rgba(16, 185, 129, 0.1); border: 1px solid #10B981; }
        .error { background: rgba(239, 68, 68, 0.1); border: 1px solid #EF4444; }
        
        .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid rgba(59, 130, 246, 0.3);
            border-top: 4px solid #3B82F6;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        button {
            background: #3B82F6;
            color: white;
            border: none;
            padding: 14px 28px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            margin: 15px 5px;
            transition: all 0.3s;
            font-family: inherit;
        }
        
        button:hover {
            background: #2563EB;
            transform: translateY(-2px);
        }
        
        .user-info {
            background: rgba(255, 255, 255, 0.05);
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            text-align: left;
        }
        
        .user-info div {
            margin: 10px 0;
            display: flex;
            justify-content: space-between;
        }
        
        .user-info strong {
            color: #94A3B8;
        }
        
        .user-info span {
            color: #E2E8F0;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="logo">
            <i class="fas fa-robot"></i>
        </div>
        
        <h1>–ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–π –≤—Ö—ñ–¥</h1>
        <p>–û–±—Ä–æ–±–∫–∞ –¥–∞–Ω–∏—Ö –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó...</p>
        
        <div id="status" class="status-box loading">
            <div class="spinner"></div>
            <p id="statusText">–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤...</p>
        </div>
        
        <div id="userInfo" class="user-info" style="display: none;">
            <div>
                <strong>ID –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞:</strong>
                <span id="infoId">-</span>
            </div>
            <div>
                <strong>–Ü–º'—è:</strong>
                <span id="infoName">-</span>
            </div>
            <div>
                <strong>–°—Ç–∞—Ç—É—Å:</strong>
                <span id="infoStatus">-</span>
            </div>
        </div>
        
        <div id="buttons" style="display: none;">
            <button onclick="goToAdmin()" id="adminBtn">
                <i class="fas fa-sign-in-alt"></i> –ü–µ—Ä–µ–π—Ç–∏ –≤ –∞–¥–º—ñ–Ω–∫—É
            </button>
            <button onclick="goToLogin()" style="background: #64748B;">
                <i class="fas fa-home"></i> –ù–∞ –≥–æ–ª–æ–≤–Ω—É
            </button>
        </div>
    </div>
    
    <!-- Font Awesome –¥–ª—è –∏–∫–æ–Ω–æ–∫ -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/js/all.min.js"></script>
    
    <script>
        // –§—É–Ω–∫—Ü—ñ—è –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤ –∑ URL
        function getUrlParams() {
            const params = new URLSearchParams(window.location.search);
            return {
                id: params.get('id'),
                first_name: params.get('first_name'),
                username: params.get('username') || '',
                approved: params.get('approved'),
                token: params.get('token'),
                source: params.get('source') || 'telegram_bot'
            };
        }
        
        // –§—É–Ω–∫—Ü—ñ—è –¥–ª—è –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö –≤ localStorage
        function saveToLocalStorage(userData) {
            try {
                console.log('üíæ –ó–±–µ—Ä—ñ–≥–∞—î–º–æ –¥–∞–Ω—ñ –≤ localStorage:', userData);
                
                // –û—Å–Ω–æ–≤–Ω—ñ –¥–∞–Ω—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
                const userToSave = {
                    id: userData.id,
                    first_name: userData.first_name,
                    username: userData.username || '',
                    auth_date: Math.floor(Date.now() / 1000),
                    source: userData.source,
                    approved: true
                };
                
                localStorage.setItem('telegram_user', JSON.stringify(userToSave));
                localStorage.setItem('user_id', userData.id);
                localStorage.setItem('user_name', userData.first_name);
                
                // –Ø–∫—â–æ —Ü–µ –∞–¥–º—ñ–Ω (ID: 5316593741)
                if (userData.id === '5316593741') {
                    localStorage.setItem('is_admin', 'true');
                }
                
                // –ß–∞—Å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó
                localStorage.setItem('auth_time', Date.now().toString());
                localStorage.setItem('auto_login', 'true');
                
                console.log('‚úÖ –î–∞–Ω—ñ –∑–±–µ—Ä–µ–∂–µ–Ω–æ:');
                console.log('- telegram_user:', localStorage.getItem('telegram_user'));
                console.log('- user_id:', localStorage.getItem('user_id'));
                console.log('- is_admin:', localStorage.getItem('is_admin'));
                
                return true;
            } catch (error) {
                console.error('‚ùå –ü–æ–º–∏–ª–∫–∞ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è:', error);
                return false;
            }
        }
        
        // –§—É–Ω–∫—Ü—ñ—è –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ —Ç–æ–∫–µ–Ω–∞ (–æ–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ)
        function validateToken(userId, token) {
            // –¢—É—Ç –º–æ–∂–Ω–∞ –¥–æ–¥–∞—Ç–∏ –ø–µ—Ä–µ–≤—ñ—Ä–∫—É —Ç–æ–∫–µ–Ω–∞ –∑ —Å–µ—Ä–≤–µ—Ä–∞
            // –î–ª—è –ø—Ä–æ—Å—Ç–æ—Ç–∏ –∑–∞–ª–∏—à–∞—î–º–æ –±–∞–∑–æ–≤—É –ø–µ—Ä–µ–≤—ñ—Ä–∫—É
            if (!token) return true;
            
            // –ü—Ä–æ—Å—Ç–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ - —Ç–æ–∫–µ–Ω –º–∞—î –º—ñ—Å—Ç–∏—Ç–∏ ID –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
            return token.includes(userId);
        }
        
        // –§—É–Ω–∫—Ü—ñ—è –¥–ª—è –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –ø—Ä–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
        function showUserInfo(userData) {
            document.getElementById('infoId').textContent = userData.id;
            document.getElementById('infoName').textContent = userData.first_name;
            document.getElementById('infoStatus').textContent = userData.approved === 'true' ? '–ü—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–∏–π' : '–û—á—ñ–∫—É—î –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è';
            document.getElementById('userInfo').style.display = 'block';
        }
        
        // –§—É–Ω–∫—Ü—ñ—è –ø–µ—Ä–µ—Ö–æ–¥—É –≤ –∞–¥–º—ñ–Ω–∫—É
        function goToAdmin() {
            console.log('üöÄ –ü–µ—Ä–µ—Ö–æ–¥–∏–º–æ –≤ –∞–¥–º—ñ–Ω–∫—É...');
            window.location.href = 'index.html?auto=' + Date.now();
        }
        
        // –§—É–Ω–∫—Ü—ñ—è –ø–µ—Ä–µ—Ö–æ–¥—É –Ω–∞ —Å—Ç–æ—Ä—ñ–Ω–∫—É –≤—Ö–æ–¥—É
        function goToLogin() {
            window.location.href = 'login.html';
        }
        
        // –û—Å–Ω–æ–≤–Ω–∞ —Ñ—É–Ω–∫—Ü—ñ—è –æ–±—Ä–æ–±–∫–∏
        async function processAutoLogin() {
            const statusEl = document.getElementById('status');
            const statusText = document.getElementById('statusText');
            const buttonsEl = document.getElementById('buttons');
            
            // –û—Ç—Ä–∏–º—É—î–º–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ –∑ URL
            const params = getUrlParams();
            console.log('üì• –û—Ç—Ä–∏–º–∞–Ω—ñ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏:', params);
            
            // –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ –æ–±–æ–≤'—è–∑–∫–æ–≤—ñ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏
            if (!params.id || !params.first_name) {
                statusText.textContent = '‚ùå –ü–æ–º–∏–ª–∫–∞: –í—ñ–¥—Å—É—Ç–Ω—ñ –æ–±–æ–≤\'—è–∑–∫–æ–≤—ñ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏';
                statusEl.className = 'status-box error';
                
                // –ü–æ–∫–∞–∑—É—î–º–æ –∫–Ω–æ–ø–∫–∏
                buttonsEl.style.display = 'block';
                return;
            }
            
            // –î–µ–∫–æ–¥—É—î–º–æ —ñ–º'—è (—è–∫—â–æ –≤–æ–Ω–æ –∑–∞–∫–æ–¥–æ–≤–∞–Ω–µ)
            const firstName = decodeURIComponent(params.first_name);
            
            // –ü–æ–∫–∞–∑—É—î–º–æ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
            showUserInfo({
                id: params.id,
                first_name: firstName,
                approved: params.approved
            });
            
            // –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ —Å—Ç–∞—Ç—É—Å –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è
            if (params.approved !== 'true') {
                statusText.textContent = '‚è≥ –û—á—ñ–∫—É—î—Ç—å—Å—è –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞';
                statusEl.className = 'status-box loading';
                return;
            }
            
            // –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ —Ç–æ–∫–µ–Ω (—è–∫—â–æ –≤—ñ–Ω —î)
            if (!validateToken(params.id, params.token)) {
                statusText.textContent = '‚ùå –ù–µ–≤—ñ—Ä–Ω–∏–π —Ç–æ–∫–µ–Ω –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó';
                statusEl.className = 'status-box error';
                buttonsEl.style.display = 'block';
                return;
            }
            
            // –ó–±–µ—Ä—ñ–≥–∞—î–º–æ –¥–∞–Ω—ñ –≤ localStorage
            statusText.textContent = 'üíæ –ó–±–µ—Ä—ñ–≥–∞—î–º–æ –¥–∞–Ω—ñ —Å–µ—Å—ñ—ó...';
            
            const userData = {
                id: params.id,
                first_name: firstName,
                username: params.username,
                approved: params.approved,
                source: params.source
            };
            
            const saved = saveToLocalStorage(userData);
            
            if (saved) {
                statusText.textContent = '‚úÖ –î–∞–Ω—ñ —É—Å–ø—ñ—à–Ω–æ –∑–±–µ—Ä–µ–∂–µ–Ω–æ!';
                statusEl.className = 'status-box success';
                
                // –ü–æ–∫–∞–∑—É—î–º–æ –∫–Ω–æ–ø–∫–∏
                buttonsEl.style.display = 'block';
                
                // –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–π –ø–µ—Ä–µ—Ö—ñ–¥ —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥–∏
                setTimeout(() => {
                    goToAdmin();
                }, 3000);
            } else {
                statusText.textContent = '‚ùå –ü–æ–º–∏–ª–∫–∞ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö';
                statusEl.className = 'status-box error';
                buttonsEl.style.display = 'block';
            }
        }
        
        // –ó–∞–ø—É—Å–∫–∞—î–º–æ –æ–±—Ä–æ–±–∫—É –ø—Ä–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—ñ —Å—Ç–æ—Ä—ñ–Ω–∫–∏
        document.addEventListener('DOMContentLoaded', processAutoLogin);
        
        // –î–æ–¥–∞—î–º–æ –æ–±—Ä–æ–±–∫—É –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å –≤—ñ–¥ Telegram Web App
        window.addEventListener('message', function(event) {
            if (event.origin === 'https://oauth.telegram.org') {
                console.log('–û—Ç—Ä–∏–º–∞–Ω–æ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –≤—ñ–¥ Telegram:', event.data);
            }
        });
    </script>
</body>
</html>
